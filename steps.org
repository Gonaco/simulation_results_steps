#+TITLE: Simulation Results steps
#+AUTHOR: Daniel Moreno Manzano

#+LATEX_HEADER: \usepackage{geometry}
#+LATEX_HEADER: \geometry{left=2.5cm,right=2.5cm,top=2.5cm,bottom=2.5cm}

#+OPTIONS: toc:nil


* First Step

#+caption: Benchmark used
#+NAME: tab:bench1
#+ATTR_LATEX: :booktabs :environment
|-----------+----------+---------+---------------------|
| Benchmark | # qubits | # gates | two-qubit gates (%) |
|-----------+----------+---------+---------------------|
| 4gt11_82  |        5 |      27 | 67                  |
|-----------+----------+---------+---------------------|

#+caption: Step 1 results after 100 iterations
#+NAME: tab:step1
#+ATTR_LATEX: :booktabs :environment
|-------------+-------------+-------+-------+------------+------------+-----------+-------|
| Mapper      | Init. place | $t_1$ | $t_2$ | meas. err. | p. success |       $f$ | $V_Q$ |
|-------------+-------------+-------+-------+------------+------------+-----------+-------|
| No          | No          |  3000 |  3000 |       0.03 |       0.99 |   0.98879 |   390 |
|-------------+-------------+-------+-------+------------+------------+-----------+-------|
| minextendrc | No          |  3000 |  3000 |       0.03 |       0.96 | 0.9404637 |  1582 |
| minextendrc | Yes         |  3000 |  3000 |       0.03 |       0.98 | 0.9675513 |  1038 |
| minextend   | No          |  3000 |  3000 |       0.03 |       0.98 |  0.944128 |  1264 |
| minextend   | Yes         |  3000 |  3000 |       0.03 |       0.98 | 0.9585909 |   834 |
| base        | No          |  3000 |  3000 |       0.03 |       0.97 |   0.92331 |  1062 |
| base        | Yes         |  3000 |  3000 |       0.03 |       0.98 | 0.9568084 |   780 |
|-------------+-------------+-------+-------+------------+------------+-----------+-------|

#+caption: Other mapper statistics
#+NAME: tab:step1_other
#+ATTR_LATEX: :booktabs :environment :font \small
|-------------+-------------+----------+-------+---------+---------+-------------+--------------------|
| Mapper      | Init. place | # qubits | depth | # gates | # SWAPS | Parallelism | # meet. in between |
|-------------+-------------+----------+-------+---------+---------+-------------+--------------------|
| No          | No          |        5 |    78 |      84 |       0 |      0.0714 |                  0 |
|-------------+-------------+----------+-------+---------+---------+-------------+--------------------|
| minextendrc | No          |        7 |   226 |     237 |      17 |      0.0464 |                  3 |
| minextendrc | Yes         |        6 |   173 |     174 |      10 |      0.0057 |                  2 |
| minextend   | No          |        8 |   158 |     228 |      16 |      0.3070 |                  1 |
| minextend   | Yes         |        6 |   139 |     165 |       9 |      0.1576 |                  0 |
| base        | No          |        6 |   177 |     228 |      16 |      0.2237 |                    |
| base        | Yes         |        6 |   130 |     147 |       7 |      0.1156 |                    |
|-------------+-------------+----------+-------+---------+---------+-------------+--------------------|
#+TBLFM: $7=1-$4/$5;%0.4f


$$\text{Parallelism: }\quad 1 - \frac{depth}{\# gates}$$

** Routing comparison

*** No initial placement

#+BEGIN_EXPORT latex
\begin{minipage}[t]{.45\textwidth}
#+END_EXPORT

_With Resource constraints_

#+BEGIN_SRC shell
... the minimally extending path with swaps is: cycleExtend=10
        path from source[1]=[2]
        path from target[2]=[1->5] implying: swap(q1,q5)
... the minimally extending path with swaps is: cycleExtend=9
        path from source[1]=[3]
        path from target[2]=[2->0] implying: swap(q2,q0)
... the minimally extending path with swaps is: cycleExtend=20
        path from source[3]=[4->7->5] implying: swap(q4,q7) swap(q7,q5)
        path from target[3]=[3->0->2] implying: swap(q3,q0) swap(q0,q2)
... the minimally extending path with swaps is: cycleExtend=9
        path from source[1]=[0]
        path from target[2]=[5->2] implying: swap(q5,q2)
... the minimally extending path with swaps is: cycleExtend=12
        path from source[2]=[7->5] implying: swap(q7,q5)
        path from target[2]=[0->2] implying: swap(q0,q2)
... the minimally extending path with swaps is: cycleExtend=9
        path from source[1]=[5]
        path from target[2]=[0->2] implying: swap(q0,q2)
... the minimally extending path with swaps is: cycleExtend=9
        path from source[1]=[5]
        path from target[2]=[0->2] implying: swap(q0,q2)
... the minimally extending path with swaps is: cycleExtend=10
        path from source[1]=[0]
        path from target[2]=[5->2] implying: swap(q5,q2)
... the minimally extending path with swaps is: cycleExtend=13
        path from source[2]=[0->2] implying: swap(q0,q2)
        path from target[2]=[7->5] implying: swap(q7,q5)
... the minimally extending path with swaps is: cycleExtend=10
        path from source[1]=[2]
        path from target[2]=[3->0] implying: swap(q3,q0)
... the minimally extending path with swaps is: cycleExtend=10
        path from source[1]=[2]
        path from target[2]=[3->0] implying: swap(q3,q0)
... the minimally extending path with swaps is: cycleExtend=10
        path from source[1]=[7]
        path from target[2]=[2->5] implying: swap(q2,q5)
#+END_SRC

#+BEGIN_EXPORT latex
\end{minipage}
\hfill %\hspace{1cm}
\begin{minipage}[t]{.45\textwidth}
#+END_EXPORT

_Without Resource constraints_

#+BEGIN_SRC shell

... the minimally extending path with swaps is: cycleExtend=10
        path from source[1]=[2]
        path from target[2]=[1->5] implying: swap(q1,q5)
... the minimally extending path with swaps is: cycleExtend=0
        path from source[2]=[3->0] implying: swap(q3,q0)
        path from target[1]=[2]
... the minimally extending path with swaps is: cycleExtend=9
        path from source[3]=[4->1->5] implying: swap(q4,q1) swap(q1,q5)
        path from target[2]=[0->2] implying: swap(q0,q2)
... the minimally extending path with swaps is: cycleExtend=0
        path from source[3]=[3->6->8] implying: swap(q3,q6) swap(q6,q8)
        path from target[1]=[5]
... the minimally extending path with swaps is: cycleExtend=10
        path from source[1]=[1]
        path from target[2]=[8->5] implying: swap(q8,q5)
... the minimally extending path with swaps is: cycleExtend=10
        path from source[1]=[1]
        path from target[2]=[8->5] implying: swap(q8,q5)
... the minimally extending path with swaps is: cycleExtend=10
        path from source[1]=[1]
        path from target[2]=[8->5] implying: swap(q8,q5)
... the minimally extending path with swaps is: cycleExtend=10
        path from source[1]=[8]
        path from target[2]=[1->5] implying: swap(q1,q5)
... the minimally extending path with swaps is: cycleExtend=0
        path from source[1]=[8]
        path from target[2]=[2->6] implying: swap(q2,q6)
... the minimally extending path with swaps is: cycleExtend=8
        path from source[1]=[8]
        path from target[3]=[0->2->5] implying: swap(q0,q2) swap(q2,q5)
... the minimally extending path with swaps is: cycleExtend=4
        path from source[1]=[8]
        path from target[2]=[2->6] implying: swap(q2,q6)
... the minimally extending path with swaps is: cycleExtend=2
        path from source[2]=[1->5] implying: swap(q1,q5)
        path from target[1]=[8]

#+END_SRC

#+BEGIN_EXPORT latex
\end{minipage}
#+END_EXPORT


*** With initial placement

# In this example one can see that to move a critical qubit (one of the most used) far from the other critical qubits is a causing extra SWAPS

#+BEGIN_EXPORT latex
\begin{minipage}[t]{.45\textwidth}
#+END_EXPORT

_With Resource constraints_

#+BEGIN_SRC shell

... Virt2Real(v->r) ... result Virt2Real map of InitialPlace before adding unused virtual qubits and unused locations : (0->10) (1->4) (2->1) (3->5) (4->7) (5->2147483647) (6->2147483647) (7->2147483647) (8->2147483647) (9->2147483647) (10->2147483647) (11->2147483647) (12->2147483647) (13->2147483647) (14->2147483647) (15->2147483647) (16->2147483647)
... Virt2Real(v->r) ... final result Virt2Real map of InitialPlace: (0->10) (1->4) (2->1) (3->5) (4->7) (5->0) (6->2) (7->3) (8->6) (9->8) (10->9) (11->11) (12->12) (13->13) (14->14) (15->15) (16->16)
... the minimally extending path with swaps is: cycleExtend=10
        path from source[1]=[4]
        path from target[2]=[10->7] implying: swap(q10,q7)
... the minimally extending path with swaps is: cycleExtend=10
        path from source[1]=[4]
        path from target[2]=[10->7] implying: swap(q10,q7)
... the minimally extending path with swaps is: cycleExtend=10
        path from source[1]=[4]
        path from target[2]=[10->7] implying: swap(q10,q7)
... the minimally extending path with swaps is: cycleExtend=10
        path from source[1]=[10]
        path from target[2]=[4->7] implying: swap(q4,q7)
... the minimally extending path with swaps is: cycleExtend=10
        path from source[1]=[10]
        path from target[2]=[5->8] implying: swap(q5,q8)
... the minimally extending path with swaps is: cycleExtend=10
        path from source[2]=[10->8] implying: swap(q10,q8)
        path from target[2]=[1->5] implying: swap(q1,q5)
... the minimally extending path with swaps is: cycleExtend=10
        path from source[1]=[8]
        path from target[2]=[7->5] implying: swap(q7,q5)
... the minimally extending path with swaps is: cycleExtend=12
        path from source[2]=[4->1] implying: swap(q4,q1)
        path from target[2]=[8->5] implying: swap(q8,q5)
#+END_SRC

#+BEGIN_EXPORT latex
\end{minipage}
\hfill %\hspace{1cm}
\begin{minipage}[t]{.45\textwidth}
#+END_EXPORT

_Without Resource constraints_

#+BEGIN_SRC shell

... Virt2Real(v->r) ... result Virt2Real map of InitialPlace before adding unused virtual qubits and unused locations : (0->10) (1->4) (2->1) (3->5) (4->7) (5->2147483647) (6->2147483647) (7->2147483647) (8->2147483647) (9->2147483647) (10->2147483647) (11->2147483647) (12->2147483647) (13->2147483647) (14->2147483647) (15->2147483647) (16->2147483647)
... Virt2Real(v->r) ... final result Virt2Real map of InitialPlace: (0->10) (1->4) (2->1) (3->5) (4->7) (5->0) (6->2) (7->3) (8->6) (9->8) (10->9) (11->11) (12->12) (13->13) (14->14) (15->15) (16->16)
... the minimally extending path with swaps is: cycleExtend=10
        path from source[1]=[4]
        path from target[2]=[10->7] implying: swap(q10,q7)
... the minimally extending path with swaps is: cycleExtend=10
        path from source[1]=[4]
        path from target[2]=[10->7] implying: swap(q10,q7)
... the minimally extending path with swaps is: cycleExtend=10
        path from source[1]=[4]
        path from target[2]=[10->7] implying: swap(q10,q7)
... the minimally extending path with swaps is: cycleExtend=10
        path from source[1]=[10]
        path from target[2]=[4->7] implying: swap(q4,q7)
... the minimally extending path with swaps is: cycleExtend=0
        path from source[1]=[10]
        path from target[2]=[5->8] implying: swap(q5,q8)
... the minimally extending path with swaps is: cycleExtend=8
        path from source[1]=[10]
        path from target[3]=[1->5->7] implying: swap(q1,q5) swap(q5,q7)
... the minimally extending path with swaps is: cycleExtend=4
        path from source[1]=[10]
        path from target[2]=[5->8] implying: swap(q5,q8)
... the minimally extending path with swaps is: cycleExtend=2
        path from source[2]=[4->7] implying: swap(q4,q7)
        path from target[1]=[10]
#+END_SRC


#+BEGIN_EXPORT latex
\end{minipage}
#+END_EXPORT

** Conclusions                                                    :noexport:

Even though it is soon to set general conclusions, we can observe some interesting behaviors in this case

- To meet the qubits in between does not look like a good option
- In the case of the initial placement, moving the main qubits -- the qubits with information -- far from the places assigned initially is making the routing worst

* 1000 iterations

#+caption: Step 1 results after 1000 iterations
#+NAME: tab:step1000
#+ATTR_LATEX: :booktabs :environment
|-------------+-------------+-------+-------+------------+------------+------------+-------|
| Mapper      | Init. place | $t_1$ | $t_2$ | meas. err. | p. success |        $f$ | $V_Q$ |
|-------------+-------------+-------+-------+------------+------------+------------+-------|
| No          | No          |  3000 |  3000 |       0.03 |       0.96 | 0.97823066 |   390 |
|-------------+-------------+-------+-------+------------+------------+------------+-------|
| minextendrc | No          |  3000 |  3000 |       0.03 |      0.929 | 0.92937318 |  1582 |
| minextendrc | Yes         |  3000 |  3000 |       0.03 |      0.939 | 0.94685216 |  1038 |
| minextend   | No          |  3000 |  3000 |       0.03 |      0.947 |  0.9312172 |  1264 |
| minextend   | Yes         |  3000 |  3000 |       0.03 |      0.949 | 0.94748374 |   834 |
| base        | No          |  3000 |  3000 |       0.03 |      0.932 |   0.906571 |  1062 |
| base        | Yes         |  3000 |  3000 |       0.03 |     0.9509 |  0.9459456 |   780 |
|-------------+-------------+-------+-------+------------+------------+------------+-------|

** Conclusions                                                    :noexport:

- P. success and $f$ is different between 100 and 1000 iterations

* 10000 iterations

#+caption: Step 1 results after 10000 iterations
#+NAME: tab:step10000
#+ATTR_LATEX: :booktabs :environment
|-------------+-------------+-------+-------+------------+------------+-------------+-------|
| Mapper      | Init. place | $t_1$ | $t_2$ | meas. err. | p. success |         $f$ | $V_Q$ |
|-------------+-------------+-------+-------+------------+------------+-------------+-------|
| No          | No          |  3000 |  3000 |       0.03 |      0.961 | 0.980342528 |   390 |
|-------------+-------------+-------+-------+------------+------------+-------------+-------|
| minextendrc | No          |  3000 |  3000 |       0.03 |     0.9372 | 0.937136544 |  1582 |
| minextendrc | Yes         |  3000 |  3000 |       0.03 |     0.9435 | 0.951650597 |  1038 |
| minextend   | No          |  3000 |  3000 |       0.03 |     0.9519 |  0.93665818 |  1264 |
| minextend   | Yes         |  3000 |  3000 |       0.03 |     0.9556 | 0.954629151 |   834 |
| base        | no          |  3000 |  3000 |       0.03 |     0.9417 |   0.9156453 |  1062 |
| base        | yes         |  3000 |  3000 |       0.03 |      0.953 |  0.95037428 |   780 |
|-------------+-------------+-------+-------+------------+------------+-------------+-------|

** Conclusions


*** Probability of success
#+TBLNAME: ps
|-------------+-------------+---------+----------+-----------+---------------+-----------------|
| Mapper      | Init. place | 100 it. | 1000 it. | 10000 it. | Diff 100-1000 | Diff 1000-10000 |
|-------------+-------------+---------+----------+-----------+---------------+-----------------|
| No          | No          |    0.99 |     0.96 |     0.961 |       -0.0300 |          0.0010 |
|-------------+-------------+---------+----------+-----------+---------------+-----------------|
| minextendrc | No          |    0.96 |    0.929 |    0.9372 |       -0.0310 |          0.0082 |
| minextendrc | Yes         |    0.98 |    0.939 |    0.9435 |       -0.0410 |          0.0045 |
| minextend   | No          |    0.98 |    0.947 |    0.9519 |       -0.0330 |          0.0049 |
| minextend   | Yes         |    0.98 |    0.949 |    0.9556 |       -0.0310 |          0.0066 |
| base        | No          |    0.97 |    0.932 |    0.9417 |       -0.0380 |          0.0097 |
| base        | Yes         |    0.98 |   0.9509 |     0.953 |       -0.0291 |          0.0021 |
|-------------+-------------+---------+----------+-----------+---------------+-----------------|
#+TBLFM: $6=$4-$3;%0.4f
#+TBLFM: $7=$5-$4;%0.4f

|-----------------------+-----------|
| Iterations comparison | Mean diff |
|-----------------------+-----------|
|              100-1000 |   -0.0333 |
|            1000-10000 |    0.0053 |
|-----------------------+-----------|
#+TBLFM: @2$2=vmean(remote(ps,@2$6..@8$6));%0.4f
#+TBLFM: @3$2=vmean(remote(ps,@2$7..@8$7));%0.4f




*** Fidelity

#+TBLNAME: f
|-------------+-------------+-----------+------------+-------------+---------------+-----------------|
| Mapper      | Init. place |   100 it. |   1000 it. |   10000 it. | Diff 100-1000 | Diff 1000-10000 |
|-------------+-------------+-----------+------------+-------------+---------------+-----------------|
| No          | No          |   0.98879 | 0.97823066 | 0.980342528 |       -0.0106 |          0.0021 |
|-------------+-------------+-----------+------------+-------------+---------------+-----------------|
| minextendrc | No          | 0.9404637 | 0.92937318 | 0.937136544 |       -0.0111 |          0.0078 |
| minextendrc | Yes         | 0.9675513 | 0.94685216 | 0.951650597 |       -0.0207 |          0.0048 |
| minextend   | No          |  0.944128 |  0.9312172 |  0.93665818 |       -0.0129 |          0.0054 |
| minextend   | Yes         | 0.9585909 | 0.94748374 | 0.954629151 |       -0.0111 |          0.0071 |
| base        | No          |   0.92331 |   0.906571 |   0.9156453 |       -0.0167 |          0.0091 |
| base        | Yes         | 0.9568084 |  0.9459456 |  0.95037428 |       -0.0109 |          0.0044 |
|-------------+-------------+-----------+------------+-------------+---------------+-----------------|
#+TBLFM: $6=$4-$3;%0.4f      
#+TBLFM: $7=$5-$4;%0.4f      

|-----------------------+-----------|
| Iterations comparison | Mean diff |
|-----------------------+-----------|
|              100-1000 |   -0.0134 |
|            1000-10000 |    0.0058 |
|-----------------------+-----------|
#+TBLFM: @2$2=vmean(remote(f,@2$6..@8$6));%0.4f
#+TBLFM: @3$2=vmean(remote(f,@2$7..@8$7));%0.4f






* Simplest benchmarks results

** 4gt11_82

** 4gt12-v1_89

** 4gt4-v0_72

** 4mod5-bdd_287

** 4mod5-v0_20

** sqrt8_260

** grover_orcl_toff

** shor_15
